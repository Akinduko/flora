define(["ojs/ojcore","knockout","ojs/ojknockout","ojs/ojfilepicker"],function(o,a){return new function(){var o=this;o.amazonJobName="",o.filename=a.observable("No file selected"),o.googleText=a.observable(""),o.amazonText=a.observable(""),o.transcriptionProgress=a.observable(""),o.googleTranscriptionProgress=a.observable(""),o.amazonTranscriptionProgress=a.observable(""),o.supportedFiles=["audio/wav","audio/mpeg","audio/x-flac","audio/flac"],o.checkAmazonStatus=async function(){console.log(o.amazonJobName);let a=await axios.get(`https://rightful-blowgun.glitch.me/transcribe/amazon/status/${o.amazonJobName}`);"completed"===a.data.status?(o.amazonText(a.data.transcription),o.amazonTranscriptionProgress("Transcription completed.")):o.amazonTranscriptionProgress("Transcription job in progress.")},o.selectListener=function(a){var e=a.detail.files;if(e[0].name.match(/\.wav$|\.flac$|\.mp3/g)){o.filename(e[0].name),o.amazonTranscriptionProgress("Starting transcription job"),o.googleTranscriptionProgress("Transcribing file.."),o.amazonText(""),o.googleText("");let a=e[0].name.substring(e[0].name.lastIndexOf(".")+1,e[0].name.length);console.log(a);let n=new FormData;n.append("audio",e[0]),axios.post(`https://rightful-blowgun.glitch.me/transcribe/google/${a}`,n).then(a=>{o.googleText(a.data.transcription),o.googleTranscriptionProgress("Transcription completed.")}).catch(a=>{console.log(a),o.googleTranscriptionProgress("Transcription failed.")}),axios.post(`https://rightful-blowgun.glitch.me/transcribe/amazon/${a}`,n).then(a=>{o.amazonJobName=a.data.transcriptionJobName,o.amazonTranscriptionProgress("Transcription job started.")}).catch(a=>{console.log(a),o.amazonTranscriptionProgress("Transcription failed.")})}else alert("Please select a valid MP3/WAV/FLAC file.")}}});